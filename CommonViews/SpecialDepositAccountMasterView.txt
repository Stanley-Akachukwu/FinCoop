SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER   VIEW [Deposits].[SpecialDepositAccountMasterView]
  as select

 ROW_NUMBER() OVER (ORDER BY SpecialDepositAccount.[Id]) AS RowNumber,
SpecialDepositAccount.[Id],
 SpecialDepositAccount.[ApplicationId],
 SpecialDepositAccount.[AccountNo],
 SpecialDepositAccount.[CustomerId],
 SpecialDepositAccount.[DepositProductId],
 SpecialDepositAccount.[DepositAccountId],
 SpecialDepositAccount.[ChargesAccruedAccountId],
 SpecialDepositAccount.[ChargesIncomeAccountId],
 SpecialDepositAccount.[ChargesWaivedAccountId],
 SpecialDepositAccount.[InterestEarnedAccountId],
 SpecialDepositAccount.[InterestPayoutAccountId],
 SpecialDepositAccount.[FundingAmount],
 SpecialDepositAccount.[InterestRate],
 SpecialDepositAccount.[LastInterestComputationDate],
 SpecialDepositAccount.[MaximumBalanceLimit],
 SpecialDepositAccount.[MinimumBalanceLimit],
 SpecialDepositAccount.[SingleWithdrawalLimit],
 SpecialDepositAccount.[DailyWithdrawalLimit],
 SpecialDepositAccount.[WeeklyWithdrawalLimit],
 SpecialDepositAccount.[MonthlyWithdrawalLimit],
 SpecialDepositAccount.[IsClosed],
 SpecialDepositAccount.[ClosedByUserId],
 SpecialDepositAccount.[Description],
 SpecialDepositAccount.[IsActive],
 SpecialDepositAccount.[CreatedByUserId],
 SpecialDepositAccount.[DateCreated],
 SpecialDepositAccount.[UpdatedByUserId],
 SpecialDepositAccount.[DateUpdated],
 SpecialDepositAccount.[DeletedByUserId],
 SpecialDepositAccount.[IsDeleted],
 SpecialDepositAccount.[DateDeleted],
 SpecialDepositAccount.[RowVersion],
 SpecialDepositAccount.[FullText],
 SpecialDepositAccount.[Tags],
 SpecialDepositAccount.[Caption],
 SpecialDepositAccount.[DateClosed],
 SpecialDepositAccount.[AccountNo] +'('+ CustomerId.FirstName +' '+ CustomerId.LastName+')' as [Details],
ApplicationId.[ApplicationNo] as ApplicationId_ApplicationNo,
ApplicationId.[CustomerId] as ApplicationId_CustomerId,
ApplicationId.[DepositProductId] as ApplicationId_DepositProductId,
ApplicationId.[ApprovalId] as ApplicationId_ApprovalId,
ApplicationId.[Amount] as ApplicationId_Amount,
ApplicationId.[InterestRate] as ApplicationId_InterestRate,
ApplicationId.[ModeOfPayment] as ApplicationId_ModeOfPayment,
ApplicationId.[PaymentDocumentId] as ApplicationId_PaymentDocumentId,
ApplicationId.[PaymentAccountNumber] as ApplicationId_PaymentAccountNumber,
ApplicationId.[PaymentBankName] as ApplicationId_PaymentBankName,
ApplicationId.[IsActive] as ApplicationId_IsActive,
ApplicationId.[CreatedByUserId] as ApplicationId_CreatedByUserId,
ApplicationId.[UpdatedByUserId] as ApplicationId_UpdatedByUserId,
ApplicationId.[DeletedByUserId] as ApplicationId_DeletedByUserId,
ApplicationId.[IsDeleted] as ApplicationId_IsDeleted,
ApplicationId.[Tags] as ApplicationId_Tags,
ApplicationId.[Caption] as ApplicationId_Caption,
CustomerId.[CustomerNo] as CustomerId_CustomerNo,
CustomerId.[ApplicationUserId] as CustomerId_ApplicationUserId,
CustomerId.[CashAccountId] as CustomerId_CashAccountId,
CustomerId.[YearsOfService] as CustomerId_YearsOfService,
CustomerId.[IsKycStarted] as CustomerId_IsKycStarted,
CustomerId.[IsKycCompleted] as CustomerId_IsKycCompleted,
CustomerId.[KycStartDate] as CustomerId_KycStartDate,
CustomerId.[KycCompletedDate] as CustomerId_KycCompletedDate,
CustomerId.[Status] as CustomerId_Status,
CustomerId.[MemberType] as CustomerId_MemberType,
CustomerId.[Gender] as CustomerId_Gender,
CustomerId.[ProfileImageUrl] as CustomerId_ProfileImageUrl,
CustomerId.[PassportUrl] as CustomerId_PassportUrl,
CustomerId.[IdentificationType] as CustomerId_IdentificationType,
CustomerId.[IdentificationNumber] as CustomerId_IdentificationNumber,
CustomerId.[IdentificationUrl] as CustomerId_IdentificationUrl,
CustomerId.[KycSubmitted] as CustomerId_KycSubmitted,
CustomerId.[KycSubmittedOn] as CustomerId_KycSubmittedOn,
CustomerId.[KycApproved] as CustomerId_KycApproved,
CustomerId.[KycApprovedOn] as CustomerId_KycApprovedOn,
CustomerId.[KycApprovedBy] as CustomerId_KycApprovedBy,
CustomerId.[FirstName] as CustomerId_FirstName,
CustomerId.[LastName] as CustomerId_LastName,
CustomerId.[MiddleName] as CustomerId_MiddleName,
CustomerId.[DepartmentId] as CustomerId_DepartmentId,
CustomerId.[MemberId] as CustomerId_MemberId,
CustomerId.[CAI] as CustomerId_CAI,
CustomerId.[RetireeNumber] as CustomerId_RetireeNumber,
CustomerId.[StateOfOrigin] as CustomerId_StateOfOrigin,
CustomerId.[PrimaryEmail] as CustomerId_PrimaryEmail,
CustomerId.[SecondaryEmail] as CustomerId_SecondaryEmail,
CustomerId.[PrimaryPhone] as CustomerId_PrimaryPhone,
CustomerId.[SecondaryPhone] as CustomerId_SecondaryPhone,
CustomerId.[ResidentialAddress] as CustomerId_ResidentialAddress,
CustomerId.[OfficeAddress] as CustomerId_OfficeAddress,
CustomerId.[Rank] as CustomerId_Rank,
CustomerId.[JobRole] as CustomerId_JobRole,
CustomerId.[DOB] as CustomerId_DOB,
CustomerId.[Address] as CustomerId_Address,
CustomerId.[Country] as CustomerId_Country,
CustomerId.[State] as CustomerId_State,
CustomerId.[IsActive] as CustomerId_IsActive,
CustomerId.[CreatedByUserId] as CustomerId_CreatedByUserId,
CustomerId.[UpdatedByUserId] as CustomerId_UpdatedByUserId,
CustomerId.[DeletedByUserId] as CustomerId_DeletedByUserId,
CustomerId.[IsDeleted] as CustomerId_IsDeleted,
CustomerId.[Tags] as CustomerId_Tags,
CustomerId.[Caption] as CustomerId_Caption,
DepositProductId.[Code] as DepositProductId_Code,
DepositProductId.[Name] as DepositProductId_Name,
DepositProductId.[ShortName] as DepositProductId_ShortName,
DepositProductId.[ApprovalWorkflowId] as DepositProductId_ApprovalWorkflowId,
DepositProductId.[ApprovalId] as DepositProductId_ApprovalId,
DepositProductId.[MinimumAge] as DepositProductId_MinimumAge,
DepositProductId.[MaximumAge] as DepositProductId_MaximumAge,
DepositProductId.[Tenure] as DepositProductId_Tenure,
DepositProductId.[TenureValue] as DepositProductId_TenureValue,
DepositProductId.[Status] as DepositProductId_Status,
DepositProductId.[PublicationType] as DepositProductId_PublicationType,
DepositProductId.[PublishedByUserId] as DepositProductId_PublishedByUserId,
DepositProductId.[DefaultCurrencyId] as DepositProductId_DefaultCurrencyId,
DepositProductId.[BankDepositAccountId] as DepositProductId_BankDepositAccountId,
DepositProductId.[ProductDepositAccountId] as DepositProductId_ProductDepositAccountId,
DepositProductId.[ChargesIncomeAccountId] as DepositProductId_ChargesIncomeAccountId,
DepositProductId.[ChargesAccrualAccountId] as DepositProductId_ChargesAccrualAccountId,
DepositProductId.[ChargesWaivedAccountId] as DepositProductId_ChargesWaivedAccountId,
DepositProductId.[InterestPayableAccountId] as DepositProductId_InterestPayableAccountId,
DepositProductId.[InterestPayoutAccountId] as DepositProductId_InterestPayoutAccountId,
DepositProductId.[IsInterestEnabled] as DepositProductId_IsInterestEnabled,
DepositProductId.[MinimumContributionRegular] as DepositProductId_MinimumContributionRegular,
DepositProductId.[MinimumContributionRetiree] as DepositProductId_MinimumContributionRetiree,
DepositProductId.[ProductType] as DepositProductId_ProductType,
DepositProductId.[IsActive] as DepositProductId_IsActive,
DepositProductId.[CreatedByUserId] as DepositProductId_CreatedByUserId,
DepositProductId.[UpdatedByUserId] as DepositProductId_UpdatedByUserId,
DepositProductId.[DeletedByUserId] as DepositProductId_DeletedByUserId,
DepositProductId.[IsDeleted] as DepositProductId_IsDeleted,
DepositProductId.[Tags] as DepositProductId_Tags,
DepositProductId.[Caption] as DepositProductId_Caption,
DepositAccountId.[AccountType] as DepositAccountId_AccountType,
DepositAccountId.[UOM] as DepositAccountId_UOM,
DepositAccountId.[CurrencyId] as DepositAccountId_CurrencyId,
DepositAccountId.[Code] as DepositAccountId_Code,
DepositAccountId.[Name] as DepositAccountId_Name,
DepositAccountId.[ParentId] as DepositAccountId_ParentId,
DepositAccountId.[ClearedBalance] as DepositAccountId_ClearedBalance,
DepositAccountId.[UnclearedBalance] as DepositAccountId_UnclearedBalance,
DepositAccountId.[LedgerBalance] as DepositAccountId_LedgerBalance,
DepositAccountId.[AvailableBalance] as DepositAccountId_AvailableBalance,
DepositAccountId.[IsOfficeAccount] as DepositAccountId_IsOfficeAccount,
DepositAccountId.[AllowManualEntry] as DepositAccountId_AllowManualEntry,
DepositAccountId.[IsClosed] as DepositAccountId_IsClosed,
DepositAccountId.[DateClosed] as DepositAccountId_DateClosed,
DepositAccountId.[ClosedByUserName] as DepositAccountId_ClosedByUserName,
DepositAccountId.[IsActive] as DepositAccountId_IsActive,
DepositAccountId.[CreatedByUserId] as DepositAccountId_CreatedByUserId,
DepositAccountId.[UpdatedByUserId] as DepositAccountId_UpdatedByUserId,
DepositAccountId.[DeletedByUserId] as DepositAccountId_DeletedByUserId,
DepositAccountId.[IsDeleted] as DepositAccountId_IsDeleted,
DepositAccountId.[Tags] as DepositAccountId_Tags,
DepositAccountId.[Caption] as DepositAccountId_Caption,
ChargesAccruedAccountId.[AccountType] as ChargesAccruedAccountId_AccountType,
ChargesAccruedAccountId.[UOM] as ChargesAccruedAccountId_UOM,
ChargesAccruedAccountId.[CurrencyId] as ChargesAccruedAccountId_CurrencyId,
ChargesAccruedAccountId.[Code] as ChargesAccruedAccountId_Code,
ChargesAccruedAccountId.[Name] as ChargesAccruedAccountId_Name,
ChargesAccruedAccountId.[ParentId] as ChargesAccruedAccountId_ParentId,
ChargesAccruedAccountId.[ClearedBalance] as ChargesAccruedAccountId_ClearedBalance,
ChargesAccruedAccountId.[UnclearedBalance] as ChargesAccruedAccountId_UnclearedBalance,
ChargesAccruedAccountId.[LedgerBalance] as ChargesAccruedAccountId_LedgerBalance,
ChargesAccruedAccountId.[AvailableBalance] as ChargesAccruedAccountId_AvailableBalance,
ChargesAccruedAccountId.[IsOfficeAccount] as ChargesAccruedAccountId_IsOfficeAccount,
ChargesAccruedAccountId.[AllowManualEntry] as ChargesAccruedAccountId_AllowManualEntry,
ChargesAccruedAccountId.[IsClosed] as ChargesAccruedAccountId_IsClosed,
ChargesAccruedAccountId.[DateClosed] as ChargesAccruedAccountId_DateClosed,
ChargesAccruedAccountId.[ClosedByUserName] as ChargesAccruedAccountId_ClosedByUserName,
ChargesAccruedAccountId.[IsActive] as ChargesAccruedAccountId_IsActive,
ChargesAccruedAccountId.[CreatedByUserId] as ChargesAccruedAccountId_CreatedByUserId,
ChargesAccruedAccountId.[UpdatedByUserId] as ChargesAccruedAccountId_UpdatedByUserId,
ChargesAccruedAccountId.[DeletedByUserId] as ChargesAccruedAccountId_DeletedByUserId,
ChargesAccruedAccountId.[IsDeleted] as ChargesAccruedAccountId_IsDeleted,
ChargesAccruedAccountId.[Tags] as ChargesAccruedAccountId_Tags,
ChargesAccruedAccountId.[Caption] as ChargesAccruedAccountId_Caption,
ChargesIncomeAccountId.[AccountType] as ChargesIncomeAccountId_AccountType,
ChargesIncomeAccountId.[UOM] as ChargesIncomeAccountId_UOM,
ChargesIncomeAccountId.[CurrencyId] as ChargesIncomeAccountId_CurrencyId,
ChargesIncomeAccountId.[Code] as ChargesIncomeAccountId_Code,
ChargesIncomeAccountId.[Name] as ChargesIncomeAccountId_Name,
ChargesIncomeAccountId.[ParentId] as ChargesIncomeAccountId_ParentId,
ChargesIncomeAccountId.[ClearedBalance] as ChargesIncomeAccountId_ClearedBalance,
ChargesIncomeAccountId.[UnclearedBalance] as ChargesIncomeAccountId_UnclearedBalance,
ChargesIncomeAccountId.[LedgerBalance] as ChargesIncomeAccountId_LedgerBalance,
ChargesIncomeAccountId.[AvailableBalance] as ChargesIncomeAccountId_AvailableBalance,
ChargesIncomeAccountId.[IsOfficeAccount] as ChargesIncomeAccountId_IsOfficeAccount,
ChargesIncomeAccountId.[AllowManualEntry] as ChargesIncomeAccountId_AllowManualEntry,
ChargesIncomeAccountId.[IsClosed] as ChargesIncomeAccountId_IsClosed,
ChargesIncomeAccountId.[DateClosed] as ChargesIncomeAccountId_DateClosed,
ChargesIncomeAccountId.[ClosedByUserName] as ChargesIncomeAccountId_ClosedByUserName,
ChargesIncomeAccountId.[IsActive] as ChargesIncomeAccountId_IsActive,
ChargesIncomeAccountId.[CreatedByUserId] as ChargesIncomeAccountId_CreatedByUserId,
ChargesIncomeAccountId.[UpdatedByUserId] as ChargesIncomeAccountId_UpdatedByUserId,
ChargesIncomeAccountId.[DeletedByUserId] as ChargesIncomeAccountId_DeletedByUserId,
ChargesIncomeAccountId.[IsDeleted] as ChargesIncomeAccountId_IsDeleted,
ChargesIncomeAccountId.[Tags] as ChargesIncomeAccountId_Tags,
ChargesIncomeAccountId.[Caption] as ChargesIncomeAccountId_Caption,
ChargesWaivedAccountId.[AccountType] as ChargesWaivedAccountId_AccountType,
ChargesWaivedAccountId.[UOM] as ChargesWaivedAccountId_UOM,
ChargesWaivedAccountId.[CurrencyId] as ChargesWaivedAccountId_CurrencyId,
ChargesWaivedAccountId.[Code] as ChargesWaivedAccountId_Code,
ChargesWaivedAccountId.[Name] as ChargesWaivedAccountId_Name,
ChargesWaivedAccountId.[ParentId] as ChargesWaivedAccountId_ParentId,
ChargesWaivedAccountId.[ClearedBalance] as ChargesWaivedAccountId_ClearedBalance,
ChargesWaivedAccountId.[UnclearedBalance] as ChargesWaivedAccountId_UnclearedBalance,
ChargesWaivedAccountId.[LedgerBalance] as ChargesWaivedAccountId_LedgerBalance,
ChargesWaivedAccountId.[AvailableBalance] as ChargesWaivedAccountId_AvailableBalance,
ChargesWaivedAccountId.[IsOfficeAccount] as ChargesWaivedAccountId_IsOfficeAccount,
ChargesWaivedAccountId.[AllowManualEntry] as ChargesWaivedAccountId_AllowManualEntry,
ChargesWaivedAccountId.[IsClosed] as ChargesWaivedAccountId_IsClosed,
ChargesWaivedAccountId.[DateClosed] as ChargesWaivedAccountId_DateClosed,
ChargesWaivedAccountId.[ClosedByUserName] as ChargesWaivedAccountId_ClosedByUserName,
ChargesWaivedAccountId.[IsActive] as ChargesWaivedAccountId_IsActive,
ChargesWaivedAccountId.[CreatedByUserId] as ChargesWaivedAccountId_CreatedByUserId,
ChargesWaivedAccountId.[UpdatedByUserId] as ChargesWaivedAccountId_UpdatedByUserId,
ChargesWaivedAccountId.[DeletedByUserId] as ChargesWaivedAccountId_DeletedByUserId,
ChargesWaivedAccountId.[IsDeleted] as ChargesWaivedAccountId_IsDeleted,
ChargesWaivedAccountId.[Tags] as ChargesWaivedAccountId_Tags,
ChargesWaivedAccountId.[Caption] as ChargesWaivedAccountId_Caption,
InterestEarnedAccountId.[AccountType] as InterestEarnedAccountId_AccountType,
InterestEarnedAccountId.[UOM] as InterestEarnedAccountId_UOM,
InterestEarnedAccountId.[CurrencyId] as InterestEarnedAccountId_CurrencyId,
InterestEarnedAccountId.[Code] as InterestEarnedAccountId_Code,
InterestEarnedAccountId.[Name] as InterestEarnedAccountId_Name,
InterestEarnedAccountId.[ParentId] as InterestEarnedAccountId_ParentId,
InterestEarnedAccountId.[ClearedBalance] as InterestEarnedAccountId_ClearedBalance,
InterestEarnedAccountId.[UnclearedBalance] as InterestEarnedAccountId_UnclearedBalance,
InterestEarnedAccountId.[LedgerBalance] as InterestEarnedAccountId_LedgerBalance,
InterestEarnedAccountId.[AvailableBalance] as InterestEarnedAccountId_AvailableBalance,
InterestEarnedAccountId.[IsOfficeAccount] as InterestEarnedAccountId_IsOfficeAccount,
InterestEarnedAccountId.[AllowManualEntry] as InterestEarnedAccountId_AllowManualEntry,
InterestEarnedAccountId.[IsClosed] as InterestEarnedAccountId_IsClosed,
InterestEarnedAccountId.[DateClosed] as InterestEarnedAccountId_DateClosed,
InterestEarnedAccountId.[ClosedByUserName] as InterestEarnedAccountId_ClosedByUserName,
InterestEarnedAccountId.[IsActive] as InterestEarnedAccountId_IsActive,
InterestEarnedAccountId.[CreatedByUserId] as InterestEarnedAccountId_CreatedByUserId,
InterestEarnedAccountId.[UpdatedByUserId] as InterestEarnedAccountId_UpdatedByUserId,
InterestEarnedAccountId.[DeletedByUserId] as InterestEarnedAccountId_DeletedByUserId,
InterestEarnedAccountId.[IsDeleted] as InterestEarnedAccountId_IsDeleted,
InterestEarnedAccountId.[Tags] as InterestEarnedAccountId_Tags,
InterestEarnedAccountId.[Caption] as InterestEarnedAccountId_Caption,
InterestPayoutAccountId.[AccountType] as InterestPayoutAccountId_AccountType,
InterestPayoutAccountId.[UOM] as InterestPayoutAccountId_UOM,
InterestPayoutAccountId.[CurrencyId] as InterestPayoutAccountId_CurrencyId,
InterestPayoutAccountId.[Code] as InterestPayoutAccountId_Code,
InterestPayoutAccountId.[Name] as InterestPayoutAccountId_Name,
InterestPayoutAccountId.[ParentId] as InterestPayoutAccountId_ParentId,
InterestPayoutAccountId.[ClearedBalance] as InterestPayoutAccountId_ClearedBalance,
InterestPayoutAccountId.[UnclearedBalance] as InterestPayoutAccountId_UnclearedBalance,
InterestPayoutAccountId.[LedgerBalance] as InterestPayoutAccountId_LedgerBalance,
InterestPayoutAccountId.[AvailableBalance] as InterestPayoutAccountId_AvailableBalance,
InterestPayoutAccountId.[IsOfficeAccount] as InterestPayoutAccountId_IsOfficeAccount,
InterestPayoutAccountId.[AllowManualEntry] as InterestPayoutAccountId_AllowManualEntry,
InterestPayoutAccountId.[IsClosed] as InterestPayoutAccountId_IsClosed,
InterestPayoutAccountId.[DateClosed] as InterestPayoutAccountId_DateClosed,
InterestPayoutAccountId.[ClosedByUserName] as InterestPayoutAccountId_ClosedByUserName,
InterestPayoutAccountId.[IsActive] as InterestPayoutAccountId_IsActive,
InterestPayoutAccountId.[CreatedByUserId] as InterestPayoutAccountId_CreatedByUserId,
InterestPayoutAccountId.[UpdatedByUserId] as InterestPayoutAccountId_UpdatedByUserId,
InterestPayoutAccountId.[DeletedByUserId] as InterestPayoutAccountId_DeletedByUserId,
InterestPayoutAccountId.[IsDeleted] as InterestPayoutAccountId_IsDeleted,
InterestPayoutAccountId.[Tags] as InterestPayoutAccountId_Tags,
InterestPayoutAccountId.[Caption] as InterestPayoutAccountId_Caption,
ClosedByUserId.[AdObjectId] as ClosedByUserId_AdObjectId,
ClosedByUserId.[IsAdmin] as ClosedByUserId_IsAdmin,
ClosedByUserId.[SecondaryPhone] as ClosedByUserId_SecondaryPhone,
ClosedByUserId.[SecondaryPhoneConfirmed] as ClosedByUserId_SecondaryPhoneConfirmed,
ClosedByUserId.[UserName] as ClosedByUserId_UserName,
ClosedByUserId.[NormalizedUserName] as ClosedByUserId_NormalizedUserName,
ClosedByUserId.[Email] as ClosedByUserId_Email,
ClosedByUserId.[NormalizedEmail] as ClosedByUserId_NormalizedEmail,
ClosedByUserId.[EmailConfirmed] as ClosedByUserId_EmailConfirmed,
ClosedByUserId.[PasswordHash] as ClosedByUserId_PasswordHash,
ClosedByUserId.[SecurityStamp] as ClosedByUserId_SecurityStamp,
ClosedByUserId.[ConcurrencyStamp] as ClosedByUserId_ConcurrencyStamp,
ClosedByUserId.[PhoneNumber] as ClosedByUserId_PhoneNumber,
ClosedByUserId.[PhoneNumberConfirmed] as ClosedByUserId_PhoneNumberConfirmed,
ClosedByUserId.[TwoFactorEnabled] as ClosedByUserId_TwoFactorEnabled,
ClosedByUserId.[LockoutEnd] as ClosedByUserId_LockoutEnd,
ClosedByUserId.[LockoutEnabled] as ClosedByUserId_LockoutEnabled,
ClosedByUserId.[AccessFailedCount] as ClosedByUserId_AccessFailedCount

 from Deposits.[SpecialDepositAccount] SpecialDepositAccount

 left join Deposits.SpecialDepositAccountApplication ApplicationId on ApplicationId.Id=SpecialDepositAccount.ApplicationId
 left join Customer.Customer CustomerId on CustomerId.Id=SpecialDepositAccount.CustomerId
 left join Deposits.DepositProduct DepositProductId on DepositProductId.Id=SpecialDepositAccount.DepositProductId
 left join Accounting.LedgerAccount DepositAccountId on DepositAccountId.Id=SpecialDepositAccount.DepositAccountId
 left join Accounting.LedgerAccount ChargesAccruedAccountId on ChargesAccruedAccountId.Id=SpecialDepositAccount.ChargesAccruedAccountId
 left join Accounting.LedgerAccount ChargesIncomeAccountId on ChargesIncomeAccountId.Id=SpecialDepositAccount.ChargesIncomeAccountId
 left join Accounting.LedgerAccount ChargesWaivedAccountId on ChargesWaivedAccountId.Id=SpecialDepositAccount.ChargesWaivedAccountId
 left join Accounting.LedgerAccount InterestEarnedAccountId on InterestEarnedAccountId.Id=SpecialDepositAccount.InterestEarnedAccountId
 left join Accounting.LedgerAccount InterestPayoutAccountId on InterestPayoutAccountId.Id=SpecialDepositAccount.InterestPayoutAccountId
 left join Security.ApplicationUser ClosedByUserId on ClosedByUserId.Id=SpecialDepositAccount.ClosedByUserId
GO
