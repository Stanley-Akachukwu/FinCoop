@page "/approval/workflows/edit/{id}"
@using AP.ChevronCoop.AppDomain.Security.Approvals.ApprovalGroups;
@using AP.ChevronCoop.Entities.Security.Approvals.ApprovalGroups;


<div class="px-4 pt-6">
<div class="col-span-3 sm:col-span-3">
    <a href="/approval/workflows/list">
        <button class="text-CEMCS-Blue-100 border border-CEMCS-Blue-100 bg-white hover:bg-white focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800"
                type="submit">
            <svg class="inline mr-1"
                 width="14"
                 height="12"
                 viewBox="0 0 14 12"
                 fill="none"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M1 5.99967H13Z" fill="#1F82BD"/>
                <path d="M5.66667 10.6663L1 5.99967M1 5.99967L5.66667 1.33301M1 5.99967H13"
                      stroke="#1F82BD"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"/>
            </svg>
            Back
        </button>
    </a>
</div>

<!-- Request Tabs -->

<div class="grid grid-cols-1 px-2 pt-6 xl:grid-cols-9 xl:gap-2 space-x-24 dark:bg-gray-900">
<div class="col-span-2">
    <div class="bg-white rounded-lg shadow sm:p-6 xl:p-8 dark:bg-gray-800">
        <div class="items-start pb-4 flex flex-col xl:block 2xl:flex sm:space-x-4 xl:space-x-0 2xl:space-x-4">
            <h3 class="pb-4 text-gray-900 font-bold text-xl">
                Approval workflow
            </h3>
            <div class="flex flex-row">
                <div class="flex flex-col items-center justify-center max-w-max">
                    <svg width="20"
                         height="20"
                         viewBox="0 0 20 20"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                        <circle cx="10"
                                cy="10"
                                r="9"
                                stroke="#1F82BD"
                                stroke-width="2"/>
                    </svg>
                    <svg width="1"
                         height="34"
                         viewBox="0 0 1 34"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                        <line x1="0.5"
                              y1="0.5"
                              x2="0.5"
                              y2="33.5"
                              stroke="#9CA3AF"
                              stroke-linecap="round"
                              stroke-dasharray="2 2"/>
                        <line x1="0.5"
                              y1="0.5"
                              x2="0.5"
                              y2="33.5"
                              stroke="#9CA3AF"
                              stroke-linecap="round"
                              stroke-dasharray="2 2"/>
                        <line x1="0.5"
                              y1="0.5"
                              x2="0.5"
                              y2="33.5"
                              stroke="#9CA3AF"
                              stroke-linecap="round"
                              stroke-dasharray="2 2"/>
                        <line x1="0.5"
                              y1="0.5"
                              x2="0.5"
                              y2="33.5"
                              stroke="#9CA3AF"
                              stroke-linecap="round"
                              stroke-dasharray="2 2"/>
                        <line x1="0.5"
                              y1="0.5"
                              x2="0.5"
                              y2="33.5"
                              stroke="#9CA3AF"
                              stroke-linecap="round"
                              stroke-dasharray="2 2"/>
                    </svg>
                </div>
                <p class="pl-4 text-sm font-semibold">Basic information</p>
            </div>
            <div class="flex flex-row">
                <div class="flex flex-col items-center justify-center max-w-max">
                    <svg width="20"
                         height="20"
                         viewBox="0 0 20 20"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                        <circle cx="10"
                                cy="10"
                                r="9"
                                stroke="#9CA3AF"
                                stroke-width="2"/>
                    </svg>
                </div>
                <p class="pl-4 text-sm font-medium">Approval Notification configuration</p>
            </div>
        </div>
    </div>
</div>
<div class="col-span-6">
    <div class="">

        <div class="w-full p-4 mb-4 bg-white rounded-lg shadow sm:p-6 xl:p-8 dark:bg-gray-800">
            <h3 class="mb-4 text-xl font-bold dark:text-white">
                Basic Information
            </h3>

            <div class="grid grid-cols-6 gap-6">
                <div class="col-span-6">
                    <label for="workflow-name"
                           class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                        Workflow name
                    </label>


                    <SfTextBox ID="member-name" Placeholder="Enter group name" CssClass="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                               @bind-Value=@WorkflowName OnBlur="OnBlur" Min="1">
                    </SfTextBox>
                </div>
            </div>

        </div>

        <div class="col-span-6 block " id="viewBox-1">
            <section class="bg-gray-50 dark:bg-gray-900">
                <div class="mx-auto max-w-screen-2xl">
                    <!-- Start coding here -->
                    <div class="bg-white dark:bg-gray-800 relative shadow-md sm:rounded-lg overflow-hidden">
                        <div class="flex flex-col py-8 md:flex-row items-center justify-between space-y-3 md:space-y-0 md:space-x-4 px-4 border-b dark:border-gray-700">
                            <div class="w-full flex flex-col">
                                <h5 class="dark:text-white font-bold text-xl">
                                    Approval group
                                </h5>
                            </div>
                            <div class="w-full flex flex-row items-center justify-end space-x-3">

                                <div class="w-full md:w-auto flex flex-col md:flex-row mb-3 md:mb-0 items-stretch md:items-center justify-end md:space-x-3 flex-shrink-0">
                                    <a href="javascript: void(0)" @onclick=@(e => OnCreateApprovalGroup()) class="w-full md:w-auto flex items-center justify-center text-white bg-green-500 hover:bg-green-600 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-3 py-2 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800">
                                        Add Group
                                    </a>
                                </div>
                            </div>
                        </div>

                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
                                <thead class="text-xs uppercase bg-gray-50 dark:bg-gray-700">
                                <tr>

                                    <th scope="col" class="px-4 py-3 min-w-[10rem]">
                                        APPROVAL GRP
                                    </th>

                                    <th scope="col" class="px-4 py-3 min-w-[10rem]">
                                        No. OF APPROVERS
                                    </th>

                                    <th scope="col" class="px-4 py-3 min-w-[6rem]">
                                        WORKFLOW SEQUENCE
                                    </th>
                                </tr>
                                </thead>
                                @if (hasSelectedDepartment)
                                {
                                    <tbody data-accordion="table-column">
                                    @foreach (var grp in selectedGroups)
                                    {
                                        <tr class="border-b dark:border-gray-700 hover:bg-gray-200 dark:hover:bg-gray-700 cursor-pointer transition"
                                            id="table-column-header-9"
                                            data-accordion-target="#table-column-body-9"
                                            aria-expanded="false"
                                            aria-controls="table-column-body-9">
                                            <th scope="row"
                                                class="px-4 py-3 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                                                @grp.GroupName
                                            </th>

                                            <td class="px-4 py-3 text-gray-500">
                                                @grp.NumberOfApprovers
                                            </td>
                                            <td class="px-4 py-3 font-normal text-gray-500 whitespace-nowrap dark:text-white">
                                                @grp.GroupApprovalSequence
                                            </td>

                                            <td class="p-4 space-x-2 whitespace-nowrap">
                                                <a href="javascript: void(0)" @onclick=@(e => OnClickDeleteGroup(grp)) class="isDisabled block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">
                                                    <svg class="inline-flex items-center mr-2 w-5 h-5" width="18" height="20" viewBox="0 0 18 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                        <path d="M7 9V15M11 9V15M1 5H17M16 5L15.133 17.142C15.0971 17.6466 14.8713 18.1188 14.5011 18.4636C14.1309 18.8083 13.6439 19 13.138 19H4.862C4.35614 19 3.86907 18.8083 3.49889 18.4636C3.1287 18.1188 2.90292 17.6466 2.867 17.142L2 5H16ZM12 5V2C12 1.73478 11.8946 1.48043 11.7071 1.29289C11.5196 1.10536 11.2652 1 11 1H7C6.73478 1 6.48043 1.10536 6.29289 1.29289C6.10536 1.48043 6 1.73478 6 2V5H12Z" stroke="#6B7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                    </svg>
                                                </a>
                                            </td>
                                        </tr>
                                    }
                                    </tbody>
                                }
                            </table>
                            @if (!hasSelectedDepartment)
                            {
                                <div class="flex flex-col items-center justify-center p-4 bg-white rounded-lg shadow sm:p-6 xl:p-8 dark:bg-gray-800">
                                    <svg width="59"
                                         height="56"
                                         viewBox="0 0 59 56"
                                         fill="none"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <path d="M22.3479 11.6667H17.5798C16.3152 11.6667 15.1024 12.1583 14.2082 13.0335C13.314 13.9087 12.8116 15.0957 12.8116 16.3333V44.3333C12.8116 45.571 13.314 46.758 14.2082 47.6332C15.1024 48.5083 16.3152 49 17.5798 49H41.4203C42.6849 49 43.8977 48.5083 44.7919 47.6332C45.6861 46.758 46.1885 45.571 46.1885 44.3333V16.3333C46.1885 15.0957 45.6861 13.9087 44.7919 13.0335C43.8977 12.1583 42.6849 11.6667 41.4203 11.6667H36.6522M22.3479 11.6667C22.3479 12.9043 22.8502 14.0913 23.7444 14.9665C24.6386 15.8417 25.8514 16.3333 27.116 16.3333H31.8841C33.1487 16.3333 34.3615 15.8417 35.2557 14.9665C36.1499 14.0913 36.6522 12.9043 36.6522 11.6667M22.3479 11.6667C22.3479 10.429 22.8502 9.242 23.7444 8.36683C24.6386 7.49167 25.8514 7 27.116 7H31.8841C33.1487 7 34.3615 7.49167 35.2557 8.36683C36.1499 9.242 36.6522 10.429 36.6522 11.6667"
                                              stroke="#0E9F6E"
                                              stroke-width="2"
                                              stroke-linecap="round"
                                              stroke-linejoin="round"/>
                                        <path d="M25.2391 26.7822L33.7609 34.0866M25.2391 34.0866L33.7609 26.7822L25.2391 34.0866Z"
                                              stroke="#0E9F6E"
                                              stroke-width="2"
                                              stroke-linecap="round"
                                              stroke-linejoin="round"/>
                                    </svg>

                                    <h5 class="text-base font-medium text-gray-900 my-4">
                                        No data yet
                                    </h5>

                                    <p class="font-medium text-sm text-gray-500 mb-6 text-center">
                                        To add approval group, simply click the "add
                                        <br/>
                                        approval group" button above.
                                    </p>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <div class="col-span-6 sm:col-span-3 flex gap-2 mt-2">
            <div class="col-span-3 sm:col-span-3">
                <form action="/approval/workflows/list">
                    <button class="text-CEMCS-Blue-100 border border-CEMCS-Blue-100 bg-white hover:bg-white focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800"
                            type="submit">
                        Back
                    </button>
                </form>
            </div>
            <div class="col-span-3 sm:col-span-3">
                @if (groupEntered)
                {
                    <button type="submit" @onclick="@ValidateWorkFlowType"
                            class="text-white bg-CEMCS-Blue-100 hover:bg-CEMCS-Blue-100 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800">
                        Proceed
                    </button>
                }

            </div>
        </div>
    </div>
</div>
</div>


</div>
<Drawer @ref="@creatGroupDrawer" Closable="true" Visible="showCreateApprovalGroupDrawer"
        OnClose="onAddApprovalGroupDone">
    <AddGroupDrawerForm @ref="@addGroupDrawerForm" @bind-Model="@selectedGroupModel"
                        @bind-ShowModal="@showCreateApprovalGroupDrawer" AddGroupToList="AddGroupToList">
    </AddGroupDrawerForm>
</Drawer>